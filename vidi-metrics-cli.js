var Emitter = require("vidi-metrics-emitter")
var jsonic = require("jsonic")
var isjson = require("is-json")
var minimist = require("minimist")
var readLineSync = require("readline-sync")
var input = minimist(process.argv.slice(2))._[0]
var ascii = "MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKOkxdoolllllodxkO0XWMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMX0xocccodxkOOOOOOkxdolccldOKWMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMWKkocldk0XNMMMMMMMMMMMMMMWNKOxlclxONMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMNkoclx0NMMMMMMMMMMMMMMMMMMMMMMMMWXkoclxKMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMXxlcd0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXxlco0WMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMWOccdKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNkccdNMMMMMMMMMMMMMM\nMMMMMMMMMMMMMNdclOWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXdcl0MMMMMMMMMMMMM\nMMMMMMMMMMMMXocoXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWxcc0MMMMMMMMMMMM\nMMMMMMMMMMMNocoNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWkccOMMMMMMMMMMM\nMMMMMMMMMMWdcoNMMNKKKKKKKKKKXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMkccKMMMMMMMMMM\nMMMMMMMMMMOcc0MMMKccccccccccxMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNlcdWMMMMMMMMM\nMMMMMMMMMWocoWMMMKccccccccccxMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMkcc0MMMMMMMMM\nMMMMMMMMMKcckMMMMKccccccccccxMMMMMMMMMMMMNkkkkkkkkkkKMMMMMMMMMMKccxMMMMMMMMM\nMMMMMMMMMOccOMMMMKccccccccccxMMMMMMMMMMMMKcccccccccckMMMMMMMMMMXccoWMMMMMMMM\nMMMMMMMMMOccldddO0ccccccccccxMMMMMMMMMMMMKcccccccccckMMMMMMMMMMXccoWMMMMMMMM\nMMMMMMMMMKccccccxKccccccccccxMMMMMMMMMMMMKcccccccccckW0OOOOOOOOkccxMMMMMMMMM\nMMMMMMMMMWocccccxKccccccccccxMWWWWWWWWWWWKcccccccccckXlccccccccccc0MMMMMMMMM\nMMMMMMMMMMOcccccxKccccccccccx0llllllllllxKcccccccccckXlccccccccccdWMMMMMMMMM\nMMMMMMMMMMWdccccxKccccccccccx0ccccccccccxKcccccccccckXlccccccccccKMMMMMMMMMM\nMMMMMMMMMMMNocccxKccccccccccx0ccccccccccxKcccccccccckXlcccccccccOMMMMMMMMMMM\nMMMMMMMMMMMMXoccx0ccccccccccx0ccccccccccxKcccccccccckXlcccccccc0MMMMMMMMMMMM\nMMMMMMMMMMMMMNdcldccccccccccx0ccccccccccxKcccccccccckXlccccccl0MMMMMMMMMMMMM\nMMMMMMMMMMMMMMWOccccccccccccx0ccccccccccxKcccccccccckXlcccccdNMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMXxlcccccccccx0ccccccccccxKcccccccccckXlccco0WMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMNOocccccccx0ccccccccccxKccccccccccloclxKMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMWKkoccccokccccccccccxKccccccccccldONMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMN0xoccccccccccccodccccccldOKWMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKOkxdoolllllodxkO0XWMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM"

function emitting(inp){
  if (isjson(inp)){
    var emit = Emitter()
    inp = jsonic.stringify(inp)

    if (inp && inp !== ''){
      var input = function(inp) {
      emit.emit(jsonic(inp))
      }
      input(inp)
    }
  }
  else {
    try {
      var json = jsonic(inp)
      var emit = Emitter()
      emit.emit(json)
    }
    catch (e) {
      console.log(e)
    }
  }
}

function addJson(json, string, number) {
  if(number == 1) {
    json.name = string
  }
  else if (number == 2) {
    json.values = jsonic(string)
  }
  else if (number == 3) {
    json.tags = jsonic(string)
  }
}

if(input == null) {
  console.log(ascii)
  var json = {}
  var name = readLineSync.question("Name for json? \n")
  var values = readLineSync.question("Enter all values as a string in this form 'value1:a,value2:q' \n")
  var tags = readLineSync.question("Enter all tags as a string in this form 'firstTag:tagGoesHere,secondTag:anotherTagGoesHere'\n")
  addJson(json, name, 1)
  addJson(json, values, 2)
  addJson(json, tags, 3)
  var emit = Emitter()
  emit.emit(json)
}
else {
  emitting(input)
}
